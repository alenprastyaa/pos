import{j as L,r as i,o as N,b as d,a as S,w as E,d as e,f as C,e as p,q as b,h as T,F as z,t as u,x as H,p as B,v as M,i as V,n as F}from"./index-BFzlO9JS.js";import{a as x,S as r}from"./sweetalert2.esm.all-BgBW3QO9.js";import{_ as I}from"./AdminLayout-b4MQjzol.js";import{_ as R}from"./_plugin-vue_export-helper-DlAUqK2U.js";const G={class:"py-3 space-y-5"},U={class:"flex justify-between items-center"},q={class:"card-container rounded-lg shadow border border-divider overflow-x-auto"},Y={class:"min-w-full divide-y divide-divider"},K={class:"bg-white divide-y divide-divider"},O={key:0},J={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-main"},Q={class:"px-6 py-4 whitespace-nowrap text-sm text-body"},W={class:"px-6 py-4 whitespace-normal text-sm text-body max-w-sm"},X={class:"px-6 py-4 whitespace-nowrap text-center text-sm font-medium"},Z={class:"flex justify-center space-x-2"},ee=["onClick"],ae=["onClick"],te={key:0,class:"fixed inset-0 z-50 flex items-center justify-center modal-overlay backdrop-blur-sm"},se={class:"relative p-6 w-full max-w-lg mx-auto bg-white rounded-lg shadow-xl transform transition-all"},ne={class:"flex justify-between items-center pb-3 border-b border-divider"},le={class:"text-lg font-semibold text-title"},re={class:"flex justify-end pt-4 border-t border-divider"},oe=["disabled"],ie={key:0,class:"animate-spin h-5 w-5",viewBox:"0 0 24 24"},de=L({__name:"PelangganPage",setup(ue){const g="https://alentest.my.id/pos",P=V(),v=i([]),h=i(!1),w=i(!1),c=i(!1),m=i(!1),l=i({id:"",nama_pelanggan:"",alamat:"",hutang:"0"}),f=()=>({Authorization:`Bearer ${localStorage.getItem("authToken")}`}),$=s=>s==null||isNaN(s)?"Rp 0":new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(s),y=async()=>{var s,a;h.value=!0;try{const t=await x.get(`${g}/pelanggan`,{headers:f()});t.data.success&&(v.value=t.data.data.map(n=>({...n,hutang:String(n.hutang||"0")})))}catch(t){const n=(a=(s=t.response)==null?void 0:s.data)==null?void 0:a.message;P.push("/signin"),r.fire("Error",n,"error")}finally{h.value=!1}},j=async()=>{var s,a;if(!l.value.nama_pelanggan){r.fire("Peringatan","Nama Pelanggan harus diisi.","warning");return}m.value=!0;try{let t;const n={nama_pelanggan:l.value.nama_pelanggan,alamat:l.value.alamat};c.value?t=await x.put(`${g}/pelanggan/${l.value.id}`,n,{headers:f()}):t=await x.post(`${g}/pelanggan`,n,{headers:f()}),t.data.success?(r.fire("Berhasil",`Data pelanggan berhasil di${c.value?"update":"tambah"}.`,"success"),_(),y()):r.fire("Gagal",t.data.message||"Terjadi kesalahan saat menyimpan data.","error")}catch(t){console.error("Error saving pelanggan:",t);const n=((a=(s=t.response)==null?void 0:s.data)==null?void 0:a.message)||"Gagal terhubung ke server.";r.fire("Error",n,"error")}finally{m.value=!1}},A=async s=>{var t,n;if((await r.fire({title:"Anda Yakin?",text:"Data pelanggan yang dihapus tidak dapat dikembalikan!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Ya, Hapus!",cancelButtonText:"Batal"})).isConfirmed)try{const o=await x.delete(`${g}/pelanggan/delete/${s}`,{headers:f()});o.data.success?(r.fire("Dihapus!","Data pelanggan berhasil dihapus.","success"),y()):r.fire("Gagal",o.data.message||"Terjadi kesalahan saat menghapus data.","error")}catch(o){console.error("Error deleting pelanggan:",o);const D=((n=(t=o.response)==null?void 0:t.data)==null?void 0:n.message)||"Gagal terhubung ke server.";r.fire("Error",D,"error")}},k=s=>{s?(c.value=!0,l.value={id:s.id,nama_pelanggan:s.nama_pelanggan,alamat:s.alamat,hutang:s.hutang}):(c.value=!1,l.value={id:"",nama_pelanggan:"",alamat:"",hutang:"0"}),w.value=!0},_=()=>{w.value=!1,l.value={id:"",nama_pelanggan:"",alamat:"",hutang:"0"}};return N(()=>{y()}),(s,a)=>(d(),S(I,null,{default:E(()=>[e("div",G,[e("div",U,[a[4]||(a[4]=e("p",{class:"text-xl font-bold text-title"},"Kelola Data Pelanggan",-1)),e("button",{onClick:a[0]||(a[0]=t=>k(null)),class:"btn-primary font-semibold py-2 px-4 rounded-lg shadow-md flex items-center gap-2"},a[3]||(a[3]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})],-1),C(" Tambah Pelanggan ")]))]),a[9]||(a[9]=e("hr",{class:"border-divider"},null,-1)),e("div",q,[e("table",Y,[a[8]||(a[8]=e("thead",{class:"table-header"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider"},"No"),e("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider"},"Nama Pelanggan "),e("th",{class:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider"},"Alamat"),e("th",{class:"px-6 py-3 text-right text-xs font-medium uppercase tracking-wider"},"Sisa Hutang "),e("th",{class:"px-6 py-3 text-center text-xs font-medium uppercase tracking-wider"},"Aksi")])],-1)),e("tbody",K,[v.value.length===0&&!h.value?(d(),p("tr",O,a[5]||(a[5]=[e("td",{colspan:"6",class:"px-6 py-4 text-center text-muted"}," Belum ada data pelanggan. ",-1)]))):b("",!0),(d(!0),p(z,null,T(v.value,(t,n)=>(d(),p("tr",{key:t.id,class:"table-row-hover"},[e("td",J,u(n+1),1),e("td",Q,u(t.nama_pelanggan),1),e("td",W,u(t.alamat),1),e("td",{class:F(["px-6 py-4 whitespace-nowrap text-sm font-semibold text-right",parseFloat(t.hutang)>0?"text-danger":"text-success"])},u($(parseFloat(t.hutang))),3),e("td",X,[e("div",Z,[e("button",{onClick:o=>k(t),class:"btn-icon-edit p-1 rounded"},a[6]||(a[6]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})],-1)]),8,ee),e("button",{onClick:o=>A(t.id),class:"btn-icon-delete p-1 rounded"},a[7]||(a[7]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)]),8,ae)])])]))),128))])])])]),w.value?(d(),p("div",te,[e("div",se,[e("div",ne,[e("h3",le,u(c.value?"Edit":"Tambah")+" Pelanggan",1),e("button",{onClick:_,class:"text-muted bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm p-1.5 ml-auto inline-flex items-center"},a[10]||(a[10]=[e("svg",{class:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule":"evenodd"})],-1)]))]),e("form",{onSubmit:H(j,["prevent"]),class:"mt-4 space-y-4"},[e("div",null,[a[11]||(a[11]=e("label",{for:"nama_pelanggan",class:"block mb-2 text-sm font-medium text-title"},"Nama Pelanggan",-1)),B(e("input",{type:"text",id:"nama_pelanggan","onUpdate:modelValue":a[1]||(a[1]=t=>l.value.nama_pelanggan=t),required:"",class:"input-field w-full rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500"},null,512),[[M,l.value.nama_pelanggan]])]),e("div",null,[a[12]||(a[12]=e("label",{for:"alamat",class:"block mb-2 text-sm font-medium text-title"},"Alamat",-1)),B(e("textarea",{id:"alamat","onUpdate:modelValue":a[2]||(a[2]=t=>l.value.alamat=t),class:"input-field w-full rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500"},null,512),[[M,l.value.alamat]])]),e("div",re,[e("button",{type:"submit",disabled:m.value,class:"btn-primary font-semibold py-2 px-4 rounded-lg shadow-md disabled:bg-gray-400 flex items-center gap-2"},[m.value?(d(),p("svg",ie,a[13]||(a[13]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):b("",!0),C(" "+u(m.value?"Menyimpan...":"Simpan"),1)],8,oe)])],32)])])):b("",!0)]),_:1}))}}),fe=R(de,[["__scopeId","data-v-8291edfe"]]);export{fe as default};
