import{j as Ee,r,c as L,y as Me,o as Re,b as c,a as Ke,w as He,d as a,p as ee,v as le,u as ze,e as g,F as O,h as F,q as z,z as qe,n as w,t as o,f as G,B as Ue,x as ie,i as Le,A as V}from"./index-BFzlO9JS.js";import{a as q,S as l}from"./sweetalert2.esm.all-BgBW3QO9.js";import{_ as Oe}from"./AdminLayout-b4MQjzol.js";import{_ as Fe}from"./_plugin-vue_export-helper-DlAUqK2U.js";const Ge={class:"page-container min-h-screen py-4 px-2 space-y-4 bg-gray-100"},Ve={class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},Ye={class:"lg:col-span-2 relative"},Je={class:"relative"},Qe=["disabled"],We={key:0,class:"absolute top-full left-0 right-0 mt-1 rounded-lg border-2 border-gray-800 bg-white shadow-2xl z-50 max-h-80 overflow-y-auto"},Xe=["onClick"],Ze={class:"flex justify-between items-center"},et={class:"font-bold text-lg text-black"},tt={class:"text-green-800 font-extrabold text-lg bg-green-100 px-2 py-1 rounded"},at={key:0,disabled:""},nt=["value"],st={key:1,class:"bg-yellow-50 p-4 rounded-xl border-2 border-yellow-400 space-y-3"},rt={class:"flex items-center gap-3 border-b-2 border-yellow-200 pb-2"},ot={class:"text-lg font-black text-gray-900 uppercase"},lt={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},it={class:"mb-4"},dt={class:"text-base font-bold text-black border-b border-dashed border-gray-400 pb-1 mb-1"},ut={class:"text-xl font-black text-blue-800"},ct={class:"text-sm font-semibold text-gray-600 mt-1 flex items-center gap-1"},gt={class:"flex gap-2"},pt=["onClick"],bt=["onClick"],mt={class:"bg-white rounded-lg shadow-md border-2 border-gray-300 overflow-hidden"},ft={class:"overflow-x-auto"},vt={class:"w-full"},yt={class:"divide-y-2 divide-gray-200"},xt={key:0},ht={class:"px-4 py-3 text-base text-black font-bold text-center border-r border-gray-200"},kt={class:"px-4 py-3 border-r border-gray-200"},wt={class:"text-lg font-bold text-black"},_t={class:"text-xs text-gray-600 font-mono mt-1"},Tt={class:"px-4 py-3 text-center border-r border-gray-200"},Bt=["onUpdate:modelValue","onChange"],Ct={class:"px-4 py-3 text-right text-lg text-gray-800 font-semibold border-r border-gray-200"},jt={class:"px-4 py-3 text-right text-xl font-black text-black border-r border-gray-200 bg-gray-50"},Pt={class:"px-4 py-3 text-center"},St=["onClick"],It={class:"px-6 py-4 bg-gray-900 text-white flex justify-between items-center border-t-4 border-gray-700"},$t={class:"text-3xl font-black text-cyan-400 tracking-wider"},At={class:"grid grid-cols-1 lg:grid-cols-3 gap-6 mt-6"},Dt={class:"lg:col-span-1"},Nt={class:"bg-white p-6 rounded-xl border-2 border-gray-300 shadow-md h-full flex flex-col justify-center"},Et={class:"relative"},Mt=["value"],Rt={class:"lg:col-span-2"},Kt={class:"bg-white p-6 border-2 border-gray-300 rounded-xl shadow-md space-y-4"},Ht={class:"flex justify-between items-end border-b-2 border-dashed border-gray-300 pb-2"},zt={class:"text-2xl font-black text-black"},qt={class:"flex justify-between items-end border-b-2 border-dashed border-gray-300 pb-2"},Ut={class:"flex justify-between items-end bg-gray-100 p-3 rounded-lg border border-gray-200"},Lt={class:"text-3xl font-black text-orange-600"},Ot={class:"flex justify-between items-center pt-2 mt-2 border-t-4 border-gray-800"},Ft={class:"grid grid-cols-1 md:grid-cols-3 gap-4 mt-6 pb-8"},Gt=["disabled"],Vt={key:0,class:"animate-spin h-6 w-6",fill:"none",viewBox:"0 0 24 24"},Yt={key:1,xmlns:"http://www.w3.org/2000/svg",class:"h-8 w-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},Jt=["disabled"],de="pendingTransactions",Qt=Ee({__name:"PenjualanGrosir",setup(Wt){const ue=Le(),D="https://alentest.my.id/pos",x=r(0),ce=localStorage.getItem("role_name"),m=r(-1),Y=r([]),J=r(!1),j=r(!1),p=r(""),b=r(0),ge=r(""),U=r(null),i=r([]),h=r([]),P=r(null),S=r(null),N=r(""),f=r([]),T=r(!1),E=()=>({Authorization:`Bearer ${localStorage.getItem("authToken")}`}),pe=L(()=>{var e;return((e=S.value)==null?void 0:e.role_name)==="superadmin"});r([]);const be=r("");r(!1);const M=r(""),te=L(()=>{const e=Number(x.value)||0,t=Number(_.value)||0;return e+t}),ae=r(null),Q=r(null),me=e=>{/\d/.test(e.key)&&e.preventDefault()},fe=e=>{const t=e.replace(/\D/g,""),n=parseInt(t)||0;b.value=n,t===""?M.value="":M.value=new Intl.NumberFormat("id-ID").format(n)},ve=e=>{const t=e.target;fe(t.value)},ye=e=>{const t=e.target;b.value>0&&(t.value=b.value.toString())},xe=e=>{const t=e.target;b.value>0&&(t.value=M.value)},he=e=>{e.key==="Enter"&&(e.preventDefault(),V(()=>{var t,n;(t=Q.value)==null||t.focus(),(n=Q.value)==null||n.click()}))},ke=async e=>{if(!e.trim()){f.value=[],T.value=!1;return}try{const t=await q.get(`${D}/produk`,{params:{search:e},headers:E()});t.data.success&&t.data.data.data&&(f.value=t.data.data.data.map(n=>({barcode:n.barcode,qty:1,nama_produk:n.nama_produk,harga_jual_ritel:parseFloat(n.harga_jual_ritel)})),T.value=!0,m.value=-1)}catch(t){console.error("Error searching products:",t),f.value=[]}},we=e=>{if(!(!T.value||f.value.length===0))switch(e.key){case"ArrowDown":e.preventDefault(),m.value=Math.min(m.value+1,f.value.length-1);break;case"ArrowUp":e.preventDefault(),m.value=Math.max(m.value-1,-1);break;case"Enter":e.preventDefault(),m.value>=0&&ne(f.value[m.value]);break;case"Escape":e.preventDefault(),T.value=!1,m.value=-1;break}},ne=async e=>{const t=await Ne(e);t!==null&&(Ce(e,t),l.fire({icon:"success",title:"Berhasil",text:`${t} ${e.nama_produk} ditambahkan`,timer:1500,showConfirmButton:!1})),N.value="",f.value=[],T.value=!1,m.value=-1,V(()=>{var n;(n=U.value)==null||n.focus()})},d=e=>e==null||isNaN(e)?"Rp 0":new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(e),_e=e=>new Date(e).toLocaleDateString("id-ID",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}),_=L(()=>i.value.reduce((e,t)=>e+t.qty*t.harga_jual_ritel,0)),B=L(()=>{const e=Number(b.value)||0,t=Number(te.value)||0;return e-t}),Te=async()=>{try{const e=await q.get(`${D}/user/my/data`,{headers:E()});e.data.success&&(S.value={full_name:e.data.data.full_name,role_name:e.data.data.role_name,toko:{id:e.data.data.toko.id,nama_toko:e.data.data.toko.nama_toko,alamat:e.data.data.toko.alamat}})}catch(e){console.error("Gagal mengambil data kasir:",e)}},se=async e=>{try{const t=await q.get(`${D}/pelanggan/${e}`,{headers:E()});t.data.success&&t.data.data&&(x.value=Number(t.data.data.hutang)||0)}catch(t){console.error("Gagal mengambil hutang pelanggan:",t),x.value=0}};Me(p,async e=>{e?(await se(e),V(()=>{var t;(t=ae.value)==null||t.focus()})):x.value=0});const Be=async()=>{J.value=!0;try{const e=await q.get(`${D}/pelanggan`,{headers:E()});e.data.success&&(Y.value=e.data.data)}catch(e){console.error("Gagal mengambil data pelanggan:",e)}finally{J.value=!1}},W=()=>{p.value="",b.value=0,M.value="",i.value=[],ge.value="",P.value=null,V(()=>{var e;(e=U.value)==null||e.focus(),N.value="",f.value=[],T.value=!1})},Ce=(e,t=1)=>{const n=i.value.find(s=>s.barcode===e.barcode);n?(n.qty+=t,i.value=[n,...i.value.filter(s=>s.barcode!==e.barcode)]):i.value.unshift({barcode:e.barcode,qty:t,nama_produk:e.nama_produk,harga_jual_ritel:parseFloat(e.harga_jual_ritel)})},je=(e,t)=>{const n=i.value.find(s=>s.barcode===e);n&&(t<=0||isNaN(t)?re(e):n.qty=t)},re=e=>{i.value=i.value.filter(t=>t.barcode!==e)},oe=()=>{try{localStorage.setItem(de,JSON.stringify(h.value))}catch(e){console.error("Error saving pending transactions:",e)}},Pe=()=>{try{const e=localStorage.getItem(de);h.value=e?JSON.parse(e):[]}catch(e){console.error("Error loading pending transactions:",e),h.value=[]}},Se=async()=>{if(i.value.length===0){l.fire("Peringatan","Keranjang belanja kosong.","warning");return}if(!p.value){l.fire("Peringatan","Pelanggan harus dipilih untuk menyimpan transaksi pending.","warning");return}const e=Y.value.find(s=>s.id===p.value),t=e?e.nama_pelanggan:"Pelanggan Tidak Dikenal",n={id:Date.now(),pelanggan_id:p.value,nama_pelanggan:t,items:[...i.value],tanggal_simpan:new Date().toLocaleString("id-ID"),total:_.value};h.value.push(n),oe(),l.fire("Berhasil","Transaksi telah disimpan sebagai pending.","success"),W()},Ie=e=>{W(),p.value=e.pelanggan_id,i.value=e.items,b.value=0,P.value=e.id,l.fire("Dimuat",`Transaksi untuk ${e.nama_pelanggan} telah dimuat ke keranjang.`,"info"),X(P.value,!1)},X=(e,t=!0)=>{h.value=h.value.filter(n=>n.id!==e),oe(),t&&l.fire("Berhasil","Transaksi pending telah dihapus.","success")},$e=(e,t,n,s,v,I)=>{const $=e.total_bayar,u=e.total_harga,C=e.total_kembalian,A=e.sisa_hutang,k=y=>new Intl.NumberFormat("id-ID",{minimumFractionDigits:0}).format(y);return`
        <div style="
            font-family: Arial, Helvetica, sans-serif; 
            font-size: 11px; 
            color: #000; 
            width: 100%;
            padding-left: 22px; /* PENTING: Jarak aman agar kiri tidak potong */
            padding-right: 5px;
        ">
            <div style="text-align: center; margin-bottom: 10px;">
                <div style="font-size: 14px; margin-bottom: 5px;">${v.toUpperCase()}</div>
                <div style="font-size: 10px; line-height: 1.2;">
                    ${I.replace(/\n/g,"<br>")}
                </div>
            </div>

            <div style="border-bottom: 1px solid #000; padding-bottom: 5px; margin-bottom: 5px;">
                <div style="display: flex; justify-content: space-between;">
                    <span>ID: ${e.id.substring(0,8)}</span>
                    <span>${_e(e.createdAt)}</span>
                </div>
                <div style="display: flex; justify-content: space-between; margin-top: 2px;">
                    <span>Kasir: ${s}</span>
                </div>
                <div style="display: flex; justify-content: space-between;">
                    <span>Plg: ${t}</span>
                </div>
            </div>

            <div style="display: flex; border-bottom: 1px solid #000; padding-bottom: 2px; margin-bottom: 5px; font-size: 10px;">
                <span style="flex: 1; text-align: left;">ITEM</span>
                <span style="width: 25px; text-align: center;">Qty</span>
                <span style="width: 55px; text-align: right;">Hrg</span>
                <span style="width: 60px; text-align: right;">Total</span>
            </div>

            <div style="margin-bottom: 5px; border-bottom: 1px solid #000; padding-bottom: 5px;">
                ${n.map(y=>`
                    <div style="margin-bottom: 4px;">
                        <div style="margin-bottom: 1px;">
                            ${y.nama_produk}
                        </div>
                        <div style="display: flex; font-size: 10px;">
                            <span style="flex: 1;"></span> <span style="width: 25px; text-align: center;">${y.qty}</span>
                            <span style="width: 55px; text-align: right;">${k(y.harga_jual_ritel)}</span>
                            <span style="width: 60px; text-align: right;">${k(y.qty*y.harga_jual_ritel)}</span>
                        </div>
                    </div>
                `).join("")}
            </div>

            <div>
                <div style="display: flex; justify-content: space-between; margin-bottom: 3px; font-size: 12px;">
                    <span>TOTAL:</span>
                    <span>Rp ${k(u)}</span>
                </div>

                <div style="display: flex; justify-content: space-between; margin-bottom: 1px;">
                    <span>Tunai:</span>
                    <span>Rp ${k($)}</span>
                </div>
                
                ${C>0?`
                    <div style="display: flex; justify-content: space-between; margin-bottom: 1px;">
                        <span>Kembali:</span>
                        <span>Rp ${k(C)}</span>
                    </div>
                `:""}

                ${A>0?`
                    <div style="display: flex; justify-content: space-between; margin-top: 5px; font-size: 11px;">
                        <span>SISA HUTANG:</span>
                        <span>Rp ${k(A)}</span>
                    </div>
                `:""}
            </div>

            <div style="margin-top: 15px; text-align: center; font-size: 10px;">
                <div>Terima Kasih</div>
                <div style="margin-top: 2px;">Barang yang dibeli tidak dapat ditukar/dikembalikan</div>
            </div>
        </div>
    `},Ae=(e,t,n,s,v,I)=>{const $=$e(e,t,n,s,v,I),u=window.open("","","width=400,height=600");if(!u){l.fire("Error","Gagal membuka jendela cetak. Periksa setelan pop-up browser Anda.","error");return}u.document.write(`
        <!DOCTYPE html>
        <html>
            <head>
                <meta charset="UTF-8">
                <title>Struk #${e.id.substring(0,8)}</title>
                <style>
                    /* Reset CSS */
                    * { margin: 0; padding: 0; box-sizing: border-box; }
                    
                    body { 
                        font-family: Arial, Helvetica, sans-serif;
                        background: #fff;
                        color: #000;
                    }

                    /* PENTING: CSS Print */
                    @media print {
                        @page {
                            margin: 0; /* Hapus margin browser */
                            size: auto;
                        }
                        
                        body {
                            /* Padding CSS mengambil alih margin fisik */
                            width: 100%;
                        }
                    }
                </style>
            </head>
            <body onload="window.print(); setTimeout(() => window.close(), 1000);">
                ${$}
            </body>
        </html>
    `),u.document.close()},De=async()=>{var I,$;if(!p.value){l.fire("Peringatan","Pelanggan harus dipilih.","warning");return}if(i.value.length===0){l.fire("Peringatan","Keranjang belanja kosong.","warning");return}if(!S.value){l.fire("Error","Data kasir/toko belum dimuat. Mohon refresh halaman atau cek koneksi API.","error");return}if(pe.value&&!be.value){l.fire("Peringatan","Toko harus dipilih untuk melakukan penjualan.","warning");return}if(!(await l.fire({icon:"question",title:"Konfirmasi Transaksi",html:`<div class="text-left">
                   <p class="mb-3"><strong>Total Belanja:</strong> ${d(_.value)}</p>
                   <p class="mb-3"><strong>Uang Bayar:</strong> ${d(b.value)}</p>
                   <p class="mb-4"><strong>Kembalian/Hutang:</strong> <span class="${B.value<0?"text-red-600 font-bold ":"text-green-600 font-bold"}">${d(Math.abs(B.value))}</span></p>
                   <hr class="my-3">
                   <p class="text-sm text-gray-600">Periksa kembali data di atas sebelum melanjutkan.</p>
               </div>`,showCancelButton:!0,confirmButtonText:"Ya, Lanjutkan",cancelButtonText:"Batalkan",confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",allowOutsideClick:!1,allowEscapeKey:!1})).isConfirmed)return;const t=B.value;if(t<0){const u=Math.abs(t);if(!(await l.fire({icon:"warning",title:"Kurang Bayar!",html:`<p>Pembayaran <strong>kurang</strong> sebesar <strong>${d(u)}</strong>.</p>
                   <p class="mt-2 text-red-500 font-semibold">Transaksi ini akan dicatat sebagai <strong>Hutang</strong>.</p>
                   <p class="text-sm mt-3">Lanjutkan proses transaksi?</p>`,showCancelButton:!0,confirmButtonText:"Ya, Catat Hutang",cancelButtonText:"Batalkan Transaksi",confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",allowOutsideClick:!1,allowEscapeKey:!1})).isConfirmed)return}const n=[...i.value],s=i.value.map(u=>({barcode:u.barcode,qty:u.qty})),v={pelanggan_id:p.value,pembayaran:b.value,items:s};j.value=!0;try{const u=await q.post(`${D}/transaksi/create/ritel`,v,{headers:E()});if(u.data.success){const C=u.data.data.transaksi,A=C.sisa_hutang||0,k=C.total_kembalian||0,y=u.data.data.pelanggan.nama_pelanggan;Ae(C,y,n,S.value.full_name,S.value.toko.nama_toko,S.value.toko.alamat);let R,K,H;A>0?(H="warning",R="Transaksi Tercatat sebagai Hutang!",K=`<p class="text-lg font-bold mt-2">Pelanggan: ${y}</p>
                   <p class="text-xl font-bold mt-1 text-red-600">Sisa Hutang: ${d(A)}</p>`):A===0?(k>0?(H="success",R="Transaksi Berhasil!",K=`<p class="text-lg font-bold mt-2">Total Belanja: ${d(_.value)}</p>
                       <p class="text-lg font-bold mt-1">Uang Bayar: ${d(b.value)}</p>
                       <p class="text-xl font-bold mt-2 text-green-600">Kembalian: ${d(k)}</p>`):(H="success",R="Transaksi Berhasil!",K='<p class="text-lg font-bold mt-2">Pembayaran Lunas Pas!</p>'),ue.push("/penjualan-grosir")):(H="error",R="Error Logika Transaksi!",K='<p class="text-lg font-bold mt-2">Terdeteksi error internal. Hubungi Admin.</p>'),l.fire({icon:H,title:R,html:K,confirmButtonText:"OK",confirmButtonColor:"#0891b2",allowOutsideClick:!1,allowEscapeKey:!1,didOpen:()=>{const Z=document.querySelector(".swal2-confirm");Z&&Z.focus()}}).then(Z=>{P.value!==null&&X(P.value,!1),se(p.value),W()})}else l.fire({icon:"error",title:"Transaksi Gagal",text:u.data.message||"Terjadi kesalahan saat memproses transaksi."})}catch(u){console.error("Error transaksi:",u),l.fire({icon:"error",title:"Error",text:(($=(I=u.response)==null?void 0:I.data)==null?void 0:$.message)||"Gagal terhubung ke server."})}finally{j.value=!1}},Ne=async e=>{const t=await l.fire({title:"Jumlah Barang",html:`
            <p class="mb-3 text-gray-700 font-medium">${e.nama_produk}</p>
            <input id="qty-input" type="number" min="1" value="1" 
                class="swal2-input w-full text-center text-lg font-bold text-gray-800" 
                autofocus>
        `,showCancelButton:!0,confirmButtonText:"Tambahkan",cancelButtonText:"Batal",confirmButtonColor:"#0891b2",cancelButtonColor:"#6b7280",allowOutsideClick:!1,didOpen:()=>{const n=document.getElementById("qty-input");n&&(n.focus(),n.select(),n.addEventListener("keydown",s=>{s.key==="Enter"&&(s.preventDefault(),l.clickConfirm())}))},preConfirm:()=>{const n=document.getElementById("qty-input"),s=parseInt(n.value);return!s||s<=0||isNaN(s)?(l.showValidationMessage("Masukkan jumlah yang valid (minimal 1)"),!1):s}});return t.isConfirmed&&t.value?t.value:null};return Re(async()=>{var e;await Te(),await Be(),Pe(),(e=U.value)==null||e.focus()}),(e,t)=>(c(),Ke(Oe,null,{default:He(()=>[a("div",Ge,[a("div",Ve,[a("div",Ye,[t[4]||(t[4]=a("label",{class:"block text-base font-bold text-black mb-2 uppercase tracking-wide"}," Cari Produk (Scan Barcode) ",-1)),a("div",Je,[ee(a("input",{onKeypress:me,ref_key:"barcodeInputRef",ref:U,"onUpdate:modelValue":t[0]||(t[0]=n=>N.value=n),type:"text",placeholder:"KETIK NAMA PRODUK / SCAN BARCODE...",onInput:t[1]||(t[1]=n=>ke(N.value)),onKeydown:we,disabled:ze(ce)!=="admin",class:"w-full h-12 px-4 rounded-lg border-2 border-gray-400 focus:border-cyan-700 focus:ring-2 focus:ring-cyan-200 text-lg font-bold text-black placeholder-gray-500 transition shadow-sm"},null,40,Qe),[[le,N.value]]),t[3]||(t[3]=a("div",{class:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500"},[a("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2.5",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})])],-1))]),T.value&&f.value.length>0?(c(),g("div",We,[(c(!0),g(O,null,F(f.value,(n,s)=>(c(),g("div",{key:n.barcode,onClick:v=>ne(n),class:w([s===m.value?"bg-cyan-100 border-l-8 border-cyan-700":"hover:bg-gray-100 border-l-8 border-transparent","px-4 py-3 cursor-pointer border-b border-gray-300 transition-colors"])},[a("div",Ze,[a("div",et,o(n.nama_produk),1),a("div",tt,o(d(n.harga_jual_ritel)),1)])],10,Xe))),128))])):z("",!0)]),a("div",null,[t[6]||(t[6]=a("label",{class:"block text-base font-bold text-black mb-2 uppercase tracking-wide"}," Pilih Pelanggan ",-1)),ee(a("select",{"onUpdate:modelValue":t[2]||(t[2]=n=>p.value=n),required:"",class:"w-full h-12 rounded-lg px-4 border-2 border-gray-400 focus:border-cyan-700 text-lg font-bold text-black bg-white shadow-sm"},[t[5]||(t[5]=a("option",{value:"",disabled:"",class:"text-gray-500"},"-- Pilih Pelanggan --",-1)),J.value?(c(),g("option",at,"Memuat Data...")):z("",!0),(c(!0),g(O,null,F(Y.value,n=>(c(),g("option",{key:n.id,value:n.id},o(n.nama_pelanggan),9,nt))),128))],512),[[qe,p.value]])])]),p.value?(c(),g("div",{key:0,class:w(["p-4 rounded-lg border-l-8 shadow-sm flex justify-between items-center bg-white",x.value>0?"border-red-600 bg-red-50":"border-green-600 bg-green-50"])},[t[7]||(t[7]=a("span",{class:"text-lg font-bold text-gray-800"},"STATUS HUTANG:",-1)),a("span",{class:w(["text-2xl font-black px-4 py-1 rounded",x.value>0?"text-red-700 bg-red-100":"text-green-800 bg-green-100"])},o(d(x.value)),3)],2)):z("",!0),h.value.length>0?(c(),g("div",st,[a("div",rt,[t[8]||(t[8]=a("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 text-yellow-700",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),a("p",ot," Transaksi Pending ("+o(h.value.length)+") ",1)]),a("div",lt,[(c(!0),g(O,null,F(h.value,n=>(c(),g("div",{key:n.id,class:w(["p-4 border-2 rounded-lg cursor-pointer shadow-sm relative group",n.id===P.value?"bg-yellow-100 border-yellow-600 ring-2 ring-yellow-400":"bg-white border-gray-300 hover:border-blue-400"])},[a("div",it,[a("p",dt,o(n.nama_pelanggan),1),a("p",ut,o(d(n.total)),1),a("p",ct,[t[9]||(t[9]=a("span",null,"ðŸ•’",-1)),G(" "+o(n.tanggal_simpan),1)])]),a("div",gt,[a("button",{onClick:s=>Ie(n),class:"flex-1 bg-blue-600 hover:bg-blue-700 text-white text-sm px-3 py-2 rounded font-bold uppercase tracking-wider shadow"}," MUAT ",8,pt),a("button",{onClick:s=>X(n.id),class:"bg-red-100 hover:bg-red-200 text-red-700 border border-red-300 text-sm px-3 py-2 rounded font-bold shadow"}," HAPUS ",8,bt)])],2))),128))])])):z("",!0),a("div",mt,[a("div",ft,[a("table",vt,[t[12]||(t[12]=a("thead",{class:"bg-gray-800 text-white"},[a("tr",null,[a("th",{class:"px-4 py-3 text-left font-bold text-sm uppercase tracking-wider border-r border-gray-600 w-12"}," No"),a("th",{class:"px-4 py-3 text-left font-bold text-sm uppercase tracking-wider border-r border-gray-600"}," Nama Produk"),a("th",{class:"px-4 py-3 text-center font-bold text-sm uppercase tracking-wider border-r border-gray-600 w-32"}," Qty"),a("th",{class:"px-4 py-3 text-right font-bold text-sm uppercase tracking-wider border-r border-gray-600 w-48"}," Harga Satuan"),a("th",{class:"px-4 py-3 text-right font-bold text-sm uppercase tracking-wider border-r border-gray-600 w-48"}," Subtotal"),a("th",{class:"px-4 py-3 text-center font-bold text-sm uppercase tracking-wider w-16"},"Aksi ")])],-1)),a("tbody",yt,[i.value.length===0?(c(),g("tr",xt,t[10]||(t[10]=[a("td",{colspan:"6",class:"px-6 py-16 text-center bg-gray-50"},[a("div",{class:"flex flex-col items-center justify-center opacity-50"},[a("svg",{class:"w-20 h-20 text-gray-400 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.5",d:"M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"})]),a("p",{class:"text-xl font-bold text-gray-500 uppercase"},"Keranjang Kosong"),a("p",{class:"text-base text-gray-500"},"Scan barcode atau cari produk untuk memulai ")])],-1)]))):z("",!0),(c(!0),g(O,null,F(i.value,(n,s)=>(c(),g("tr",{key:n.barcode,class:w(["hover:bg-cyan-50 transition-colors",s%2===0?"bg-white":"bg-gray-100"])},[a("td",ht,o(s+1),1),a("td",kt,[a("div",wt,o(n.nama_produk),1),a("div",_t,"CODE: "+o(n.barcode),1)]),a("td",Tt,[ee(a("input",{"onUpdate:modelValue":v=>n.qty=v,type:"number",min:"1",onChange:v=>je(n.barcode,n.qty),class:"w-24 text-center border-2 border-gray-400 rounded-md px-2 py-2 text-xl font-bold text-black focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},null,40,Bt),[[le,n.qty,void 0,{number:!0}]])]),a("td",Ct,o(d(n.harga_jual_ritel)),1),a("td",jt,o(d(n.qty*n.harga_jual_ritel)),1),a("td",Pt,[a("button",{type:"button",onClick:v=>re(n.barcode),class:"p-2 rounded-lg bg-red-100 text-red-600 hover:bg-red-600 hover:text-white transition-all shadow-sm border border-red-200"},t[11]||(t[11]=[a("svg",{width:"24",height:"24",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2.5"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)]),8,St)])],2))),128))])])]),a("div",It,[t[13]||(t[13]=a("span",{class:"text-xl font-bold uppercase tracking-wide"},"Total Belanja Sementara",-1)),a("span",$t,o(d(_.value)),1)])]),a("div",At,[a("div",Dt,[a("div",Nt,[t[15]||(t[15]=a("label",{class:"block text-lg font-black text-black mb-3 uppercase"},[G(" Jumlah Uang Diterima "),a("span",{class:"text-red-600"},"*")],-1)),a("div",Et,[t[14]||(t[14]=a("span",{class:"absolute left-4 top-1/2 -translate-y-1/2 text-xl font-bold text-gray-500"},"Rp",-1)),a("input",{ref_key:"pembayaranInputRef",ref:ae,value:M.value||b.value||"",onInput:ve,onFocus:ye,onBlur:xe,onKeydown:Ue(he,["enter"]),type:"text",required:"",placeholder:"0",class:"w-full h-16 pl-14 pr-4 rounded-xl border-4 border-gray-800 focus:border-cyan-600 text-3xl font-black text-right text-black shadow-inner transition tracking-widest bg-yellow-50 focus:bg-white"},null,40,Mt)]),t[16]||(t[16]=a("p",{class:"text-sm text-gray-500 mt-2 font-semibold italic text-right"},"*Tekan ENTER untuk proses ",-1))])]),a("div",Rt,[a("div",Kt,[a("div",Ht,[t[17]||(t[17]=a("span",{class:"text-gray-600 font-bold text-lg uppercase"},"Total Belanja",-1)),a("span",zt,o(d(_.value)),1)]),a("div",qt,[t[18]||(t[18]=a("span",{class:"text-gray-600 font-bold text-lg uppercase"},"Hutang Lama",-1)),a("span",{class:w(["text-2xl font-black",x.value>0?"text-red-600":"text-green-600"])},o(d(x.value)),3)]),a("div",Ut,[t[19]||(t[19]=a("span",{class:"text-gray-900 font-black text-xl uppercase"},"Total Tagihan",-1)),a("span",Lt,o(d(te.value)),1)]),a("div",Ot,[a("span",{class:w(["text-2xl font-black uppercase",B.value>=0?"text-green-700":"text-red-600"])},o(B.value>=0?"KEMBALIAN":"SISA HUTANG"),3),a("span",{class:w(["text-5xl font-black tracking-tighter",B.value>=0?"text-green-700":"text-red-600"])},o(d(Math.abs(B.value))),3)])])])]),a("div",Ft,[a("button",{ref_key:"submitButtonRef",ref:Q,type:"submit",onClick:ie(De,["prevent"]),disabled:j.value||_.value===0||!p.value,class:w(["md:col-span-2 h-16 text-xl font-black text-white rounded-xl shadow-lg transition transform hover:-translate-y-1 flex items-center justify-center gap-3 uppercase tracking-wider border-b-4",j.value||_.value===0?"bg-gray-400 border-gray-500 cursor-not-allowed":"bg-cyan-600 border-cyan-800 hover:bg-cyan-500"])},[j.value?(c(),g("svg",Vt,t[20]||(t[20]=[a("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),a("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):(c(),g("svg",Yt,t[21]||(t[21]=[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"3",d:"M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z"},null,-1)]))),G(" "+o(j.value?"MEMPROSES...":"BAYAR & CETAK STRUK (ENTER)"),1)],10,Gt),a("button",{type:"button",onClick:ie(Se,["prevent"]),disabled:i.value.length===0||!p.value,class:"h-16 text-lg font-bold text-gray-800 bg-white border-4 border-gray-800 rounded-xl hover:bg-yellow-50 flex items-center justify-center gap-2 shadow-lg transition uppercase"},t[22]||(t[22]=[a("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","stroke-width":"2.5"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})],-1),G(" Simpan Pending ")]),8,Jt)])])]),_:1}))}}),aa=Fe(Qt,[["__scopeId","data-v-58611eee"]]);export{aa as default};
