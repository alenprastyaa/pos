import{j as Ia,r as s,c as F,y as za,o as Da,b as g,a as Sa,w as Aa,d as t,p as W,v as ra,u as Na,e as p,F as V,h as U,q as z,z as Ma,n as D,t as o,f as X,x as na,A as sa}from"./index-Cs9e03Zl.js";import{a as q,S as l}from"./sweetalert2.esm.all-BgBW3QO9.js";import{_ as Ea}from"./AdminLayout-Dh2wtnyM.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const Ha={class:"py-2 space-y-2 bg-gray-50 dark:bg-gray-950 min-h-screen"},qa={class:"grid grid-cols-1 lg:grid-cols-3 gap-4"},Ka={class:"lg:col-span-2 relative"},Ra=["disabled"],La={key:0,class:"absolute top-full left-0 right-0 mt-2 bg-white dark:bg-gray-900 border border-gray-200 dark:border-gray-700 rounded-lg shadow-xl z-10 max-h-200 overflow-y-auto"},Fa=["onClick"],Va={style:{"font-size":"12px"},class:"text-gray-900 dark:text-gray-100"},Ua={key:0,disabled:""},Oa=["value"],Ga={key:0,class:"p-4 bg-white dark:bg-gray-900 border border-gray-200 dark:border-gray-700 rounded-lg"},Ya={class:"flex justify-between items-center"},Ja={key:1,class:"space-y-3"},Qa={class:"flex items-center gap-2"},Wa={class:"text-sm font-bold text-gray-900 dark:text-gray-100"},Xa={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3"},Za={class:"mb-3"},ae={class:"text-sm font-semibold text-gray-900 dark:text-gray-100"},ee={class:"text-lg font-bold text-amber-600 dark:text-amber-500 mt-1"},te={class:"text-xs text-gray-500 dark:text-gray-400 mt-2"},re={class:"flex gap-2 justify-end"},ne=["onClick"],se=["onClick"],oe={class:"bg-white dark:bg-gray-900 rounded-lg shadow-sm border border-gray-200 dark:border-gray-800 overflow-hidden"},le={class:"overflow-x-auto"},ie={class:"w-full"},de={class:"divide-y divide-gray-100 dark:divide-gray-800"},ue={key:0},ge={class:"px-6 py-1 text-sm text-gray-900 dark:text-gray-100 font-medium"},ce={class:"px-6 py-1"},pe={style:{"font-size":"12px"},class:"text-gray-900 dark:text-gray-100 leading-tight"},ye={class:"px-6 py-1 text-center"},me=["onUpdate:modelValue","onChange"],be={class:"px-6 py-1 text-right text-sm text-gray-700 dark:text-gray-300"},ve={class:"px-6 py-1 text-right text-sm font-semibold text-gray-900 dark:text-gray-100"},xe={class:"px-6 py-1 text-center"},fe=["onClick"],ke={class:"px-6 py-2 bg-gray-100 dark:bg-gray-800/50 border-t border-gray-200 dark:border-gray-700 flex justify-between items-center"},he={class:"text-xl text-cyan-600 dark:text-cyan-500"},_e={class:"space-y-4 mt-4"},we={class:"relative"},Te=["value"],Be={class:"p-5 bg-white dark:bg-gray-900 border border-gray-200 dark:border-gray-700 rounded-lg space-y-3"},je={class:"flex justify-between text-sm"},Pe={class:"flex justify-between text-sm"},Ce={class:"font-semibold text-gray-900 dark:text-gray-100"},$e={class:"flex justify-between text-sm border-t border-gray-200 dark:border-gray-700 pt-3"},Ie={class:"font-semibold text-gray-900 dark:text-gray-100"},ze={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},De=["disabled"],Se=["disabled"],Ae={key:0,class:"animate-spin h-5 w-5",fill:"none",viewBox:"0 0 24 24"},oa="pendingTransactions",Ke=Ia({__name:"PenjualanGrosir",setup(Ne){const S="https://alentest.my.id/pos",h=s(0),la=localStorage.getItem("role_name"),m=s(-1),O=s([]),G=s(!1),A=s(!1),c=s(""),y=s(0),ia=s(""),K=s(null),i=s([]),x=s([]),_=s(null),B=s(null),R=s(""),f=s([]),j=s(!1),N=()=>({Authorization:`Bearer ${localStorage.getItem("authToken")}`}),da=F(()=>{var a;return((a=B.value)==null?void 0:a.role_name)==="superadmin"});s([]);const ua=s("");s(!1);const L=s(""),Y=F(()=>{const a=Number(h.value)||0,e=Number(w.value)||0;return a+e}),ga=a=>{/\d/.test(a.key)&&a.preventDefault()},ca=a=>{const e=a.replace(/\D/g,""),r=parseInt(e)||0;y.value=r,e===""?L.value="":L.value=new Intl.NumberFormat("id-ID").format(r)},pa=a=>{const e=a.target;ca(e.value)},ya=a=>{const e=a.target;y.value>0&&(e.value=y.value.toString())},ma=a=>{const e=a.target;y.value>0&&(e.value=L.value)},ba=async a=>{if(!a.trim()){f.value=[],j.value=!1;return}try{const e=await q.get(`${S}/produk`,{params:{search:a},headers:N()});e.data.success&&e.data.data.data&&(f.value=e.data.data.data.map(r=>({barcode:r.barcode,qty:1,nama_produk:r.nama_produk,harga_jual_ritel:parseFloat(r.harga_jual_ritel)})),j.value=!0,m.value=-1)}catch(e){console.error("Error searching products:",e),f.value=[]}},va=a=>{if(!(!j.value||f.value.length===0))switch(a.key){case"ArrowDown":a.preventDefault(),m.value=Math.min(m.value+1,f.value.length-1);break;case"ArrowUp":a.preventDefault(),m.value=Math.max(m.value-1,-1);break;case"Enter":a.preventDefault(),m.value>=0&&Z(f.value[m.value]);break;case"Escape":a.preventDefault(),j.value=!1,m.value=-1;break}},Z=async a=>{const e=await $a(a);e!==null&&(ha(a,e),l.fire({icon:"success",title:"Berhasil",text:`${e} ${a.nama_produk} ditambahkan`,timer:1500,showConfirmButton:!1})),R.value="",f.value=[],j.value=!1,m.value=-1,sa(()=>{var r;(r=K.value)==null||r.focus()})},d=a=>a==null||isNaN(a)?"Rp 0":new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(a),xa=a=>new Date(a).toLocaleDateString("id-ID",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}),w=F(()=>i.value.reduce((a,e)=>a+e.qty*e.harga_jual_ritel,0)),P=F(()=>{const a=Number(y.value)||0,e=Number(Y.value)||0;return a-e}),fa=async()=>{try{const a=await q.get(`${S}/user/my/data`,{headers:N()});a.data.success&&(B.value={full_name:a.data.data.full_name,role_name:a.data.data.role_name,toko:{id:a.data.data.toko.id,nama_toko:a.data.data.toko.nama_toko,alamat:a.data.data.toko.alamat}})}catch(a){console.error("Gagal mengambil data kasir:",a)}},aa=async a=>{try{const e=await q.get(`${S}/pelanggan/${a}`,{headers:N()});e.data.success&&e.data.data&&(h.value=Number(e.data.data.hutang)||0)}catch(e){console.error("Gagal mengambil hutang pelanggan:",e),h.value=0}};za(c,async a=>{a?await aa(a):h.value=0});const ka=async()=>{G.value=!0;try{const a=await q.get(`${S}/pelanggan`,{headers:N()});a.data.success&&(O.value=a.data.data)}catch(a){console.error("Gagal mengambil data pelanggan:",a)}finally{G.value=!1}},J=()=>{c.value="",y.value=0,i.value=[],ia.value="",_.value=null,sa(()=>{var a;(a=K.value)==null||a.focus()})},ha=(a,e=1)=>{const r=i.value.find(n=>n.barcode===a.barcode);r?(r.qty+=e,i.value=[r,...i.value.filter(n=>n.barcode!==a.barcode)]):i.value.unshift({barcode:a.barcode,qty:e,nama_produk:a.nama_produk,harga_jual_ritel:parseFloat(a.harga_jual_ritel)})},_a=(a,e)=>{const r=i.value.find(n=>n.barcode===a);r&&(e<=0||isNaN(e)?ea(a):r.qty=e)},ea=a=>{i.value=i.value.filter(e=>e.barcode!==a)},ta=()=>{try{localStorage.setItem(oa,JSON.stringify(x.value))}catch(a){console.error("Error saving pending transactions:",a)}},wa=()=>{try{const a=localStorage.getItem(oa);x.value=a?JSON.parse(a):[]}catch(a){console.error("Error loading pending transactions:",a),x.value=[]}},Ta=async()=>{if(i.value.length===0){l.fire("Peringatan","Keranjang belanja kosong.","warning");return}if(!c.value){l.fire("Peringatan","Pelanggan harus dipilih untuk menyimpan transaksi pending.","warning");return}const a=O.value.find(n=>n.id===c.value),e=a?a.nama_pelanggan:"Pelanggan Tidak Dikenal",r={id:Date.now(),pelanggan_id:c.value,nama_pelanggan:e,items:[...i.value],tanggal_simpan:new Date().toLocaleString("id-ID"),total:w.value};x.value.push(r),ta(),l.fire("Berhasil","Transaksi telah disimpan sebagai pending.","success"),J()},Ba=a=>{J(),c.value=a.pelanggan_id,i.value=a.items,y.value=0,_.value=a.id,l.fire("Dimuat",`Transaksi untuk ${a.nama_pelanggan} telah dimuat ke keranjang.`,"info"),Q(_.value,!1)},Q=(a,e=!0)=>{x.value=x.value.filter(r=>r.id!==a),ta(),e&&l.fire("Berhasil","Transaksi pending telah dihapus.","success")},ja=(a,e,r,n,b,C)=>{const $=a.total_bayar,u=a.total_harga,T=a.total_kembalian,I=a.sisa_hutang,k=v=>new Intl.NumberFormat("id-ID",{minimumFractionDigits:0}).format(v);return`
        <div style="width: 280px; font-family: monospace; font-size: 12px; padding: 10px; text-align: center;">
            <div style="margin-bottom: 10px;">
                <div style="font-weight: bold; font-size: 14px; margin-bottom: 5px;">${b.toUpperCase()}</div>
                <div style="font-size: 11px; line-height: 1.4;">
                    ${C.replace(/\n/g,"<br>")}
                </div>
            </div>

            <div style="border-top: 2px dashed #000; border-bottom: 2px dashed #000; padding: 8px 0; margin: 8px 0;">
                <div style="display: flex; justify-content: space-between; font-size: 11px; margin-bottom: 3px;">
                    <span><strong>ID:</strong> ${a.id.substring(0,8)}</span>
                    <span><strong>Kasir:</strong> ${n}</span>
                </div>
                <div style="display: flex; justify-content: space-between; font-size: 11px;">
                    <span><strong>Tanggal:</strong></span>
                    <span>${xa(a.createdAt)}</span>
                </div>
                <div style="display: flex; justify-content: space-between; font-size: 11px; margin-top: 3px;">
                    <span><strong>Pelanggan:</strong></span>
                    <span>${e}</span>
                </div>
            </div>

            <div style="display: flex; justify-content: space-between; font-weight: bold; font-size: 11px; margin: 8px 0 4px 0; border-bottom: 1px dashed #000; padding-bottom: 4px;">
                <span style="flex: 1; text-align: left;">ITEM</span>
                <span style="width: 30px; text-align: center;">QTY</span>
                <span style="width: 50px; text-align: right;">HARGA</span>
                <span style="width: 50px; text-align: right;">TOTAL</span>
            </div>

            <div>
                ${r.map(v=>`
                    <div style="display: flex; justify-content: space-between; font-size: 11px; margin-bottom: 4px;">
                        <span style="flex: 1; text-align: left; word-break: break-word;">${v.nama_produk}</span>
                        <span style="width: 30px; text-align: center;">${v.qty}</span>
                        <span style="width: 50px; text-align: right;">${k(v.harga_jual_ritel)}</span>
                        <span style="width: 50px; text-align: right;">${k(v.qty*v.harga_jual_ritel)}</span>
                    </div>
                `).join("")}
            </div>

            <div style="border-top: 2px dashed #000; margin: 8px 0; padding-top: 8px;">
    <div style="display: flex; justify-content: space-between; font-weight: bold; font-size: 12px; margin-bottom: 4px;">
        <span>TOTAL BELANJA:</span>
        <span>Rp ${k(u)}</span>
    </div>

    <div style="display: flex; justify-content: space-between; font-size: 11px; margin-bottom: 2px;">
        <span>Tunai:</span>
        <span>Rp ${k($)}</span>
    </div>
    
    ${T>0?`
        <div style="display: flex; justify-content: space-between; font-weight: bold; font-size: 11px; color: #2ecc71;">
            <span>Kembali:</span>
            <span>Rp ${k(T)}</span>
        </div>
    `:""}

    ${I>0?`
        <div style="display: flex; justify-content: space-between; font-weight: bold; font-size: 11px; color: #e74c3c; margin-top: 5px;">
            <span>SISA HUTANG:</span>
            <span>Rp ${k(I)}</span>
        </div>
    `:""}
    </div>


            <div style="margin-top: 10px; font-size: 11px; line-height: 1.6;">
                <div>Terima Kasih Atas Kunjungan Anda</div>
                <div>Periksa barang sebelum dibeli</div>
                <div style="font-size: 10px; color: #666;">Barang yang sudah dibeli<br>tidak bisa ditukar atau dikembalikan</div>
            </div>
        </div>
    `},Pa=(a,e,r,n,b,C)=>{const $=ja(a,e,r,n,b,C),u=window.open("","","width=350,height=700,scrollbars=yes");if(!u){l.fire("Error","Gagal membuka jendela cetak. Periksa setelan pop-up browser Anda.","error");return}u.document.write(`
        <!DOCTYPE html>
        <html>
            <head>
                <meta charset="UTF-8">
                <title>Struk Transaksi ${a.id.substring(0,8)}</title>
                <style>
                    * { margin: 0; padding: 0; box-sizing: border-box; }
                    body { 
                        font-family: 'Courier New', monospace; 
                        font-size: 12px;
                        background: #f5f5f5;
                        padding: 10px;
                    }
                    @media print {
                        body { padding: 0; background: white; }
                        @page { margin: 0; size: 80mm auto; }
                    }
                </style>
            </head>
            <body onload="window.print(); setTimeout(() => window.close(), 500);">
                ${$}
            </body>
        </html>
    `),u.document.close()},Ca=async()=>{var C,$;if(!c.value){l.fire("Peringatan","Pelanggan harus dipilih.","warning");return}if(i.value.length===0){l.fire("Peringatan","Keranjang belanja kosong.","warning");return}if(!B.value){l.fire("Error","Data kasir/toko belum dimuat. Mohon refresh halaman atau cek koneksi API.","error");return}if(da.value&&!ua.value){l.fire("Peringatan","Toko harus dipilih untuk melakukan penjualan.","warning");return}if(!(await l.fire({icon:"question",title:"Konfirmasi Transaksi",html:`<div class="text-left">
                   <p class="mb-3"><strong>Total Belanja:</strong> ${d(w.value)}</p>
                   <p class="mb-3"><strong>Uang Bayar:</strong> ${d(y.value)}</p>
                   <p class="mb-4"><strong>Kembalian/Hutang:</strong> <span class="${P.value<0?"text-red-600 font-bold ":"text-green-600 font-bold"}">${d(Math.abs(P.value))}</span></p>
                   <hr class="my-3">
                   <p class="text-sm text-gray-600">Periksa kembali data di atas sebelum melanjutkan.</p>
               </div>`,showCancelButton:!0,confirmButtonText:"Ya, Lanjutkan",cancelButtonText:"Batalkan",confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",allowOutsideClick:!1,allowEscapeKey:!1})).isConfirmed)return;const e=P.value;if(e<0){const u=Math.abs(e);if(!(await l.fire({icon:"warning",title:"Kurang Bayar!",html:`<p>Pembayaran <strong>kurang</strong> sebesar <strong>${d(u)}</strong>.</p>
                   <p class="mt-2 text-red-500 font-semibold">Transaksi ini akan dicatat sebagai <strong>Hutang</strong>.</p>
                   <p class="text-sm mt-3">Lanjutkan proses transaksi?</p>`,showCancelButton:!0,confirmButtonText:"Ya, Catat Hutang",cancelButtonText:"Batalkan Transaksi",confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",allowOutsideClick:!1,allowEscapeKey:!1})).isConfirmed)return}const r=[...i.value],n=i.value.map(u=>({barcode:u.barcode,qty:u.qty})),b={pelanggan_id:c.value,pembayaran:y.value,items:n};A.value=!0;try{const u=await q.post(`${S}/transaksi/create/ritel`,b,{headers:N()});if(u.data.success){const T=u.data.data.transaksi,I=T.sisa_hutang||0,k=T.total_kembalian||0,v=u.data.data.pelanggan.nama_pelanggan;Pa(T,v,r,B.value.full_name,B.value.toko.nama_toko,B.value.toko.alamat);let M,E,H;I>0?(H="warning",M="Transaksi Tercatat sebagai Hutang!",E=`<p class="text-lg font-bold mt-2">Pelanggan: ${v}</p>
                           <p class="text-xl font-bold mt-1 text-red-600">Sisa Hutang: ${d(I)}</p>`):I===0?k>0?(H="success",M="Transaksi Berhasil!",E=`<p class="text-lg font-bold mt-2">Total Belanja: ${d(w.value)}</p>
                               <p class="text-lg font-bold mt-1">Uang Bayar: ${d(y.value)}</p>
                               <p class="text-xl font-bold mt-2 text-green-600">Kembalian: ${d(k)}</p>`):(H="success",M="Transaksi Berhasil!",E='<p class="text-lg font-bold mt-2">Pembayaran Lunas Pas!</p>'):(H="error",M="Error Logika Transaksi!",E='<p class="text-lg font-bold mt-2">Terdeteksi error internal. Hubungi Admin.</p>'),l.fire({icon:H,title:M,html:E}),_.value!==null&&Q(_.value,!1),await aa(c.value),J()}else l.fire({icon:"error",title:"Transaksi Gagal",text:u.data.message||"Terjadi kesalahan saat memproses transaksi."})}catch(u){console.error("Error transaksi:",u),l.fire({icon:"error",title:"Error",text:(($=(C=u.response)==null?void 0:C.data)==null?void 0:$.message)||"Gagal terhubung ke server."})}finally{A.value=!1}},$a=async a=>{const e=await l.fire({title:"Jumlah Barang",html:`
            <p class="mb-3 text-gray-700 font-medium">${a.nama_produk}</p>
            <input id="qty-input" type="number" min="1" value="1" 
                class="swal2-input w-full text-center text-lg font-bold text-gray-800" 
                autofocus>
        `,showCancelButton:!0,confirmButtonText:"Tambahkan",cancelButtonText:"Batal",confirmButtonColor:"#0891b2",cancelButtonColor:"#6b7280",allowOutsideClick:!1,didOpen:()=>{const r=document.getElementById("qty-input");r&&(r.focus(),r.select(),r.addEventListener("keydown",n=>{n.key==="Enter"&&(n.preventDefault(),l.clickConfirm())}))},preConfirm:()=>{const r=document.getElementById("qty-input"),n=parseInt(r.value);return!n||n<=0||isNaN(n)?(l.showValidationMessage("Masukkan jumlah yang valid (minimal 1)"),!1):n}});return e.isConfirmed&&e.value?e.value:null};return Da(async()=>{var a;await fa(),await ka(),wa(),(a=K.value)==null||a.focus()}),(a,e)=>(g(),Sa(Ea,null,{default:Aa(()=>[t("div",Ha,[t("div",qa,[t("div",Ka,[e[3]||(e[3]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Cari Produk ",-1)),W(t("input",{onKeypress:ga,ref_key:"barcodeInputRef",ref:K,"onUpdate:modelValue":e[0]||(e[0]=r=>R.value=r),type:"text",style:{"font-size":"12px"},placeholder:"Ketik nama produk...",onInput:e[1]||(e[1]=r=>ba(R.value)),onKeydown:va,disabled:Na(la)!=="admin",class:"w-full h-8 px-4 rounded-lg border border-gray-300 dark:border-gray-700 bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100 placeholder-gray-400 dark:placeholder-gray-500 focus:ring-2 focus:ring-cyan-500 focus:border-transparent disabled:bg-gray-100 disabled:text-gray-500 dark:disabled:bg-gray-800 dark:disabled:text-gray-400 transition"},null,40,Ra),[[ra,R.value]]),j.value&&f.value.length>0?(g(),p("div",La,[(g(!0),p(V,null,U(f.value,(r,n)=>(g(),p("div",{key:r.barcode,onClick:b=>Z(r),class:D([n===m.value?"bg-yellow-300 dark:bg-cyan-900/20 border-l-4 border-cyan-500":"hover:bg-gray-50 dark:hover:bg-gray-800/50","px-2 py-1 cursor-pointer border-b border-gray-100 dark:border-gray-800 last:border-b-0 transition"])},[t("div",Va,o(r.nama_produk),1)],10,Fa))),128))])):z("",!0)]),t("div",null,[e[5]||(e[5]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Pilih Pelanggan ",-1)),W(t("select",{"onUpdate:modelValue":e[2]||(e[2]=r=>c.value=r),required:"",style:{"font-size":"12px"},class:"w-full h-8 rounded-lg border border-gray-300 dark:border-gray-700 bg-white dark:bg-gray-900 px-4 text-gray-900 dark:text-gray-100 focus:ring-2 focus:ring-cyan-500 focus:border-transparent transition"},[e[4]||(e[4]=t("option",{value:"",disabled:""},"Pilih Pelanggan...",-1)),G.value?(g(),p("option",Ua,"Memuat...")):z("",!0),(g(!0),p(V,null,U(O.value,r=>(g(),p("option",{key:r.id,value:r.id},o(r.nama_pelanggan),9,Oa))),128))],512),[[Ma,c.value]])])]),c.value?(g(),p("div",Ga,[t("div",Ya,[e[6]||(e[6]=t("span",{class:"text-sm font-medium text-gray-600 dark:text-gray-400"},"Hutang Pelanggan",-1)),t("span",{class:D(["text-lg",h.value>0?"text-red-600 dark:text-red-500":"text-emerald-600 dark:text-emerald-500"])},o(d(h.value)),3)])])):z("",!0),x.value.length>0?(g(),p("div",Ja,[t("div",Qa,[e[7]||(e[7]=t("div",{class:"w-1 h-6 bg-amber-500 rounded"},null,-1)),t("p",Wa," Transaksi Pending ("+o(x.value.length)+") ",1)]),t("div",Xa,[(g(!0),p(V,null,U(x.value,r=>(g(),p("div",{key:r.id,class:D(["p-4 bg-white dark:bg-gray-900 border-2 rounded-lg transition cursor-pointer",{"border-cyan-500 bg-yellow-300 dark:bg-cyan-900/10":r.id===_.value,"border-amber-200 dark:border-amber-800 hover:border-amber-400 dark:hover:border-amber-600":r.id!==_.value}])},[t("div",Za,[t("p",ae,o(r.nama_pelanggan),1),t("p",ee,o(d(r.total)),1),t("p",te,o(r.tanggal_simpan),1)]),t("div",re,[t("button",{onClick:n=>Ba(r),class:"text-sm bg-cyan-600 hover:bg-cyan-700 text-white px-3 py-1.5 rounded-md font-medium transition"}," Muat ",8,ne),t("button",{onClick:n=>Q(r.id),class:"text-sm bg-gray-300 dark:bg-gray-700 hover:bg-gray-400 dark:hover:bg-gray-600 text-gray-900 dark:text-gray-100 px-3 py-1.5 rounded-md font-medium transition"}," Hapus ",8,se)])],2))),128))])])):z("",!0),t("div",oe,[t("div",le,[t("table",ie,[e[10]||(e[10]=t("thead",null,[t("tr",{class:"bg-gray-100 dark:bg-gray-800/50 border-b border-gray-200 dark:border-gray-700"},[t("th",{style:{"font-size":"12px"},class:"px-6 py-4 text-left text-gray-700 dark:text-gray-300 uppercase tracking-wider"}," No"),t("th",{style:{"font-size":"12px"},class:"px-6 py-4 text-left text-gray-700 dark:text-gray-300 uppercase tracking-wider"}," Produk"),t("th",{style:{"font-size":"12px"},class:"px-6 py-4 text-center text-gray-700 dark:text-gray-300 uppercase tracking-wider"}," Qty"),t("th",{style:{"font-size":"12px"},class:"px-6 py-4 text-right text-gray-700 dark:text-gray-300 uppercase tracking-wider"}," Harga"),t("th",{style:{"font-size":"12px"},class:"px-6 py-4 text-right text-gray-700 dark:text-gray-300 uppercase tracking-wider"}," Subtotal"),t("th",{style:{"font-size":"12px"},class:"px-6 py-4 text-center text-gray-700 dark:text-gray-300 uppercase tracking-wider"})])],-1)),t("tbody",de,[i.value.length===0?(g(),p("tr",ue,e[8]||(e[8]=[t("td",{colspan:"6",class:"px-6 py-12 text-center text-gray-400 dark:text-gray-500"},[t("div",{class:"space-y-2"},[t("svg",{class:"w-12 h-12 mx-auto opacity-40",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.5",d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"})]),t("p",{class:"text-sm"},"Belum ada produk ditambahkan")])],-1)]))):z("",!0),(g(!0),p(V,null,U(i.value,(r,n)=>(g(),p("tr",{key:r.barcode,class:"hover:bg-gray-50 dark:hover:bg-gray-800/30 transition"},[t("td",ge,o(n+1),1),t("td",ce,[t("div",pe,o(r.nama_produk),1)]),t("td",ye,[W(t("input",{"onUpdate:modelValue":b=>r.qty=b,type:"number",min:"1",onChange:b=>_a(r.barcode,r.qty),class:"w-20 text-center text-gray-900 dark:text-gray-100 border border-gray-300 dark:border-gray-700 rounded-md px-2 py-1 text-sm bg-white dark:bg-gray-800 focus:ring-2 focus:ring-cyan-500 focus:border-transparent transition"},null,40,me),[[ra,r.qty,void 0,{number:!0}]])]),t("td",be,o(d(r.harga_jual_ritel)),1),t("td",ve,o(d(r.qty*r.harga_jual_ritel)),1),t("td",xe,[t("button",{type:"button",onClick:b=>ea(r.barcode),class:"text-gray-400 hover:text-red-600 dark:hover:text-red-500 p-1.5 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-md transition"},e[9]||(e[9]=[t("svg",{width:"18",height:"18",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)]),8,fe)])]))),128))])])]),t("div",ke,[e[11]||(e[11]=t("span",{class:"text-base text-gray-700 dark:text-gray-300"},"Total Belanja",-1)),t("span",he,o(d(w.value)),1)])]),t("div",_e,[t("div",null,[e[13]||(e[13]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},[X(" Jumlah Bayar "),t("span",{class:"text-red-500"},"*")],-1)),t("div",we,[e[12]||(e[12]=t("span",{class:"absolute left-4 top-1/2 -translate-y-1/2 text-sm font-semibold text-gray-500 dark:text-gray-400"}," Rp ",-1)),t("input",{value:L.value||y.value||"",onInput:pa,onFocus:ya,onBlur:ma,type:"text",required:"",placeholder:"0",class:"w-full h-10 pl-12 pr-4 rounded-lg border border-gray-300 dark:border-gray-700 bg-white dark:bg-gray-900 text-sm text-gray-900 dark:text-gray-100 placeholder-gray-400 dark:placeholder-gray-500 focus:ring-2 focus:ring-cyan-500 focus:border-transparent transition"},null,40,Te)])]),t("div",Be,[t("div",je,[e[14]||(e[14]=t("span",{class:"text-gray-600 dark:text-gray-400"},"Hutang Lama:",-1)),t("span",{class:D(["font-semibold",h.value>0?"text-red-600 dark:text-red-500":"text-emerald-600 dark:text-emerald-500"])},o(d(h.value)),3)]),t("div",Pe,[e[15]||(e[15]=t("span",{class:"text-gray-600 dark:text-gray-400"},"Total Belanja:",-1)),t("span",Ce,o(d(w.value)),1)]),t("div",{class:D(["flex justify-between text-base border-t border-gray-200 dark:border-gray-700 pt-3",Y.value>0?"text-orange-600 dark:text-orange-500":"text-gray-900 dark:text-gray-100"])},[e[16]||(e[16]=t("span",null,"Total yang Harus Dibayar:",-1)),t("span",null,o(d(Y.value)),1)],2),t("div",$e,[e[17]||(e[17]=t("span",{class:"text-gray-600 dark:text-gray-400"},"Uang Bayar:",-1)),t("span",Ie,o(d(y.value)),1)]),t("div",{class:D(["flex justify-between text-base border-t border-gray-200 dark:border-gray-700 pt-3",P.value>=0?"text-emerald-600 dark:text-emerald-500":"text-red-600 dark:text-red-500"])},[t("span",null,o(P.value>=0?"Kembalian":"Sisa Hutang"),1),t("span",null,o(d(Math.abs(P.value))),1)],2)])]),t("div",ze,[t("button",{type:"button",onClick:na(Ta,["prevent"]),disabled:i.value.length===0||!c.value,class:"h-12 bg-gray-600 hover:bg-gray-700 disabled:bg-gray-300 dark:disabled:bg-gray-700 text-white font-medium rounded-lg flex items-center justify-center gap-2 transition"},e[18]||(e[18]=[t("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","stroke-width":"2"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1),X(" Simpan (Pending) ")]),8,De),t("button",{type:"submit",onClick:na(Ca,["prevent"]),disabled:A.value||w.value===0||!c.value,class:"md:col-span-2 h-12 bg-cyan-600 hover:bg-cyan-700 disabled:bg-gray-300 dark:disabled:bg-gray-700 text-white text-base font-semibold rounded-lg flex items-center justify-center gap-2 shadow-sm transition transform hover:scale-[1.01]"},[A.value?(g(),p("svg",Ae,e[19]||(e[19]=[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):z("",!0),X(" "+o(A.value?"Memproses...":"Proses Transaksi"),1)],8,Se)])])]),_:1}))}});export{Ke as default};
