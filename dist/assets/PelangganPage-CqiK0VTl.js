import{j as L,r as i,o as N,b as d,a as S,w as E,d as e,f as C,e as m,q as b,h as T,F as z,t as g,x as H,p as B,v as M,i as V,n as F}from"./index-Cjag85Jx.js";import{a as y,S as l}from"./sweetalert2.esm.all-BgBW3QO9.js";import{_ as I}from"./AdminLayout-DHZApuQs.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const R={class:"py-3 space-y-5"},G={class:"flex justify-between items-center"},U={class:"bg-white dark:bg-gray-800 rounded-lg shadow border border-gray-200 dark:border-gray-700 overflow-x-auto"},q={class:"min-w-full divide-y divide-gray-200 dark:divide-gray-700"},Y={class:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700"},K={key:0},O={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-white"},J={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-700 dark:text-gray-300"},Q={class:"px-6 py-4 whitespace-normal text-sm text-gray-700 dark:text-gray-300 max-w-sm"},W={class:"px-6 py-4 whitespace-nowrap text-center text-sm font-medium"},X={class:"flex justify-center space-x-2"},Z=["onClick"],ee=["onClick"],ae={key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black/30 backdrop-blur-sm"},te={class:"relative p-6 w-full max-w-lg mx-auto bg-white dark:bg-gray-800 rounded-lg shadow-xl transform transition-all"},re={class:"flex justify-between items-center pb-3 border-b border-gray-200 dark:border-gray-700"},se={class:"text-lg font-semibold text-gray-900 dark:text-white"},ne={class:"flex justify-end pt-4 border-t border-gray-200 dark:border-gray-700"},le=["disabled"],oe={key:0,class:"animate-spin h-5 w-5",viewBox:"0 0 24 24"},me=L({__name:"PelangganPage",setup(ie){const p="https://alentest.my.id/pos",P=V(),h=i([]),k=i(!1),f=i(!1),u=i(!1),c=i(!1),n=i({id:"",nama_pelanggan:"",alamat:"",hutang:"0"}),x=()=>({Authorization:`Bearer ${localStorage.getItem("authToken")}`}),$=r=>r==null||isNaN(r)?"Rp 0":new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(r),v=async()=>{var r,a;k.value=!0;try{const t=await y.get(`${p}/pelanggan`,{headers:x()});t.data.success&&(h.value=t.data.data.map(s=>({...s,hutang:String(s.hutang||"0")})))}catch(t){const s=(a=(r=t.response)==null?void 0:r.data)==null?void 0:a.message;t.message,P.push("/signin"),l.fire("Error",s,"error")}},j=async()=>{var r,a;if(!n.value.nama_pelanggan){l.fire("Peringatan","Nama Pelanggan harus diisi.","warning");return}c.value=!0;try{let t;const s={nama_pelanggan:n.value.nama_pelanggan,alamat:n.value.alamat};u.value?t=await y.put(`${p}/pelanggan/${n.value.id}`,s,{headers:x()}):t=await y.post(`${p}/pelanggan`,s,{headers:x()}),t.data.success?(l.fire("Berhasil",`Data pelanggan berhasil di${u.value?"update":"tambah"}.`,"success"),_(),v()):l.fire("Gagal",t.data.message||"Terjadi kesalahan saat menyimpan data.","error")}catch(t){console.error("Error saving pelanggan:",t);const s=((a=(r=t.response)==null?void 0:r.data)==null?void 0:a.message)||"Gagal terhubung ke server.";l.fire("Error",s,"error")}finally{c.value=!1}},A=async r=>{var t,s;if((await l.fire({title:"Anda Yakin?",text:"Data pelanggan yang dihapus tidak dapat dikembalikan!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Ya, Hapus!",cancelButtonText:"Batal"})).isConfirmed)try{const o=await y.delete(`${p}/pelanggan/delete/${r}`,{headers:x()});o.data.success?(l.fire("Dihapus!","Data pelanggan berhasil dihapus.","success"),v()):l.fire("Gagal",o.data.message||"Terjadi kesalahan saat menghapus data.","error")}catch(o){console.error("Error deleting pelanggan:",o);const D=((s=(t=o.response)==null?void 0:t.data)==null?void 0:s.message)||"Gagal terhubung ke server.";l.fire("Error",D,"error")}},w=r=>{r?(u.value=!0,n.value={id:r.id,nama_pelanggan:r.nama_pelanggan,alamat:r.alamat,hutang:r.hutang}):(u.value=!1,n.value={id:"",nama_pelanggan:"",alamat:"",hutang:"0"}),f.value=!0},_=()=>{f.value=!1,n.value={id:"",nama_pelanggan:"",alamat:"",hutang:"0"}};return N(()=>{v()}),(r,a)=>(d(),S(I,null,{default:E(()=>[e("div",R,[e("div",G,[a[4]||(a[4]=e("p",{class:"text-xl font-bold text-gray-900 dark:text-white"},"Kelola Data Pelanggan",-1)),e("button",{onClick:a[0]||(a[0]=t=>w(null)),class:"bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-4 rounded-lg shadow-md flex items-center gap-2"},a[3]||(a[3]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})],-1),C(" Tambah Pelanggan ")]))]),a[9]||(a[9]=e("hr",{class:"border-gray-200 dark:border-gray-700"},null,-1)),e("div",U,[e("table",q,[a[8]||(a[8]=e("thead",{class:"bg-gray-50 dark:bg-gray-700/30"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"}," No "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"}," Nama Pelanggan "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"}," Alamat "),e("th",{class:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"}," Sisa Hutang "),e("th",{class:"px-6 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"}," Aksi ")])],-1)),e("tbody",Y,[h.value.length===0&&!k.value?(d(),m("tr",K,a[5]||(a[5]=[e("td",{colspan:"6",class:"px-6 py-4 text-center text-gray-500 dark:text-gray-400"}," Belum ada data pelanggan. ",-1)]))):b("",!0),(d(!0),m(z,null,T(h.value,(t,s)=>(d(),m("tr",{key:t.id,class:"hover:bg-gray-50 dark:hover:bg-gray-700/50"},[e("td",O,g(s+1),1),e("td",J,g(t.nama_pelanggan),1),e("td",Q,g(t.alamat),1),e("td",{class:F(["px-6 py-4 whitespace-nowrap text-sm font-semibold text-right",parseFloat(t.hutang)>0?"text-red-600 dark:text-red-400":"text-green-600 dark:text-green-400"])},g($(parseFloat(t.hutang))),3),e("td",W,[e("div",X,[e("button",{onClick:o=>w(t),class:"text-blue-600 hover:text-blue-900 dark:text-blue-400 dark:hover:text-blue-200 p-1 rounded"},a[6]||(a[6]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})],-1)]),8,Z),e("button",{onClick:o=>A(t.id),class:"text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-200 p-1 rounded"},a[7]||(a[7]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)]),8,ee)])])]))),128))])])])]),f.value?(d(),m("div",ae,[e("div",te,[e("div",re,[e("h3",se,g(u.value?"Edit":"Tambah")+" Pelanggan",1),e("button",{onClick:_,class:"text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm p-1.5 ml-auto inline-flex items-center dark:hover:bg-gray-700 dark:hover:text-white"},a[10]||(a[10]=[e("svg",{class:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{"fill-rule":"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule":"evenodd"})],-1)]))]),e("form",{onSubmit:H(j,["prevent"]),class:"mt-4 space-y-4"},[e("div",null,[a[11]||(a[11]=e("label",{for:"nama_pelanggan",class:"block mb-2 text-sm font-medium text-gray-900 dark:text-white"},"Nama Pelanggan",-1)),B(e("input",{type:"text",id:"nama_pelanggan","onUpdate:modelValue":a[1]||(a[1]=t=>n.value.nama_pelanggan=t),required:"",class:"w-full rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 px-3 py-2 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500"},null,512),[[M,n.value.nama_pelanggan]])]),e("div",null,[a[12]||(a[12]=e("label",{for:"alamat",class:"block mb-2 text-sm font-medium text-gray-900 dark:text-white"},"Alamat",-1)),B(e("textarea",{id:"alamat","onUpdate:modelValue":a[2]||(a[2]=t=>n.value.alamat=t),class:"w-full rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 px-3 py-2 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500"},null,512),[[M,n.value.alamat]])]),e("div",ne,[e("button",{type:"submit",disabled:c.value,class:"bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-4 rounded-lg shadow-md disabled:bg-gray-400 flex items-center gap-2"},[c.value?(d(),m("svg",oe,a[13]||(a[13]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):b("",!0),C(" "+g(c.value?"Menyimpan...":"Simpan"),1)],8,le)])],32)])])):b("",!0)]),_:1}))}});export{me as default};
